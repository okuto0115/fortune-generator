<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>å ã„ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <style>
    /* ==========
      ã“ã“ã ã‘è§¦ã‚Œã°ãƒ‡ã‚¶ã‚¤ãƒ³å¤‰æ›´ã§ãã‚‹ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰
    ========== */
    :root{
      --bg: #0b0b0f;
      --card: #11111a;
      --text: #f3f3f7;
      --muted: #b7b7c6;
      --line: rgba(255,255,255,.12);
      --accent: #8ab4ff;

      --radius: 14px;
      --pad: 16px;
      --gap: 12px;

      --font: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Noto Sans Mono", monospace;
    }

    body{
      margin: 0;
      background: radial-gradient(1200px 600px at 20% 0%, rgba(138,180,255,.18), transparent 55%),
                  radial-gradient(900px 500px at 90% 10%, rgba(255,140,180,.12), transparent 55%),
                  var(--bg);
      color: var(--text);
      font-family: var(--font);
      line-height: 1.7;
    }

    .wrap{ max-width: 980px; margin: 0 auto; padding: 24px; }
    header{ display:flex; flex-direction:column; gap: 6px; margin-bottom: 16px; }
    h1{ font-size: 20px; margin: 0; }
    .sub{ color: var(--muted); font-size: 13px; margin: 0; }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: var(--gap);
    }
    @media (min-width: 900px){
      .grid{ grid-template-columns: 360px 1fr; align-items:start; }
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent 42%),
                  var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: var(--pad);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    .sectionTitle{ font-size: 13px; color: var(--muted); margin: 0 0 10px; letter-spacing: .02em; }

    label{ display:block; font-size: 12px; color: var(--muted); margin: 10px 0 6px; }
    input, select{
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      outline: none;
      font-size: 14px;
    }
    input::placeholder{ color: rgba(255,255,255,.35); }

    .row2{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .btns{ display:flex; gap: 10px; flex-wrap: wrap; margin-top: 12px; }

    button{
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      cursor: pointer;
      font-size: 14px;
    }
    button.primary{
      background: var(--accent);
      border-color: transparent;
      color: #09101d;
      font-weight: 700;
    }
    button:active{ transform: translateY(1px); }

    .hint{ font-size: 12px; color: var(--muted); margin: 10px 0 0; }

    textarea{
      width:100%;
      min-height: 560px;
      border-radius: var(--radius);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      padding: 12px;
      font-family: var(--mono);
      font-size: 13px;
      white-space: pre-wrap;
      line-height: 1.65;
    }

    .mini{ font-size: 12px; color: var(--muted); }
    .pill{
      display:inline-block;
      padding: 4px 10px;
      border: 1px solid var(--line);
      border-radius: 999px;
      color: var(--muted);
      font-size: 12px;
      margin-right: 6px;
      background: rgba(255,255,255,.03);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>å ã„ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
      <p class="sub">ä¸‡äººå‘ã‘ãƒ»æ”¹å¤‰ã—ã‚„ã™ã„ãƒ†ãƒ³ãƒ—ãƒ¬ç‰ˆï¼ˆHTML/JSã ã‘ã§å‹•ä½œï¼‰</p>
    </header>

    <div class="grid">
      <!-- å·¦ï¼šå…¥åŠ› -->
      <div class="card">
        <p class="sectionTitle">å…¥åŠ›</p>

        <label>åå‰</label>
        <input id="name" placeholder="ä¾‹ï¼šå¹³å±± æµ·æ–— / å®®å´ æ­å¹³" />

        <label>ç”Ÿå¹´æœˆæ—¥</label>
        <input id="dob" type="date" />

        <div class="row2">
          <div>
            <label>å‡ºç”Ÿåœ°</label>
            <input id="place" placeholder="ä¾‹ï¼šç¦å²¡çœŒ" />
          </div>
          <div>
            <label>å‡ºç”Ÿæ™‚é–“ï¼ˆä»»æ„ï¼‰</label>
            <input id="time" placeholder="ä¾‹ï¼š23:30é ƒ / ä¸æ˜" />
          </div>
        </div>

        <label>é‘‘å®šã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆæ–‡ç« ã®é›°å›²æ°—ï¼‰</label>
        <select id="tone">
          <option value="soft">ã‚„ã•ã—ã‚</option>
          <option value="clear">ã¯ã£ãã‚Š</option>
          <option value="biz">ä»•äº‹å¯„ã‚Š</option>
        </select>

        <div class="btns">
          <button class="primary" id="gen">ç”Ÿæˆ</button>
          <button id="copy">ã‚³ãƒ”ãƒ¼</button>
          <button id="clear">ã‚¯ãƒªã‚¢</button>
        </div>

        <p class="hint">
          æ”¹å¤‰ãƒã‚¤ãƒ³ãƒˆã¯ã€ŒSCRIPTå†…ã® CONFIG / TEXT_DBã€ã€‚<br>
          æ–‡è¨€ã‚„ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆã‚’ãã“ã ã‘è§¦ã‚Œã°å¤‰ãˆã‚‰ã‚Œã‚‹ã€‚
        </p>
      </div>

      <!-- å³ï¼šå‡ºåŠ› -->
      <div class="card">
        <p class="sectionTitle">å‡ºåŠ›</p>
        <div class="mini">
          <span class="pill">æ˜Ÿåº§</span><span id="badgeSign">-</span>
          <span class="pill">æ•°ç§˜</span><span id="badgeLP">-</span>
          <span class="pill">å¹´é½¢</span><span id="badgeAge">-</span>
        </div>
        <label style="margin-top:10px;">çµæœãƒ†ã‚­ã‚¹ãƒˆ</label>
        <textarea id="out" readonly></textarea>
        <p class="hint">â€»æœ¬æ ¼å æ˜Ÿè¡“ï¼ˆå¤©ä½“è¨ˆç®—ï¼‰ã‚„å››æŸ±æ¨å‘½ã®å³å¯†è¨ˆç®—ã¯æœªæ­è¼‰ã€‚å¿…è¦ãªã‚‰æ¬¡æ®µéšã§æ‹¡å¼µã§ãã‚‹ã€‚</p>
      </div>
    </div>
  </div>

<script>
/* =========================================================================
  0) ã“ã“ãŒâ€œæ”¹å¤‰ã—ã‚„ã™ã„â€ä¸­æ¢ï¼šæ–‡ç« DBã¨è¨­å®š
============================================================================ */

// ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸¦ã³ï¼ˆè‡ªç”±ã«å…¥ã‚Œæ›¿ãˆå¯ï¼‰
const CONFIG = {
  sections: [
    "social",    // ç¤¾ä¼šã‚­ãƒ£ãƒ©
    "overall",   // å…¨ä½“é‹
    "work",      // ä»•äº‹
    "money",     // ãŠé‡‘
    "health",    // å¥åº·
    "love",      // æ‹æ„›
    "turning",   // è»¢æ›ç‚¹
    "final"      // æœ€çµ‚è©•ä¾¡
  ],
  yearNow: 2026, // ä»Šã®å¹´ï¼ˆå›ºå®šã§OK / å‹•çš„ã«ã™ã‚‹ãªã‚‰ new Date().getFullYear()ï¼‰
};

// æ–‡è¨€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼šã“ã“ã‚’å·®ã—æ›¿ãˆã‚‹ã ã‘ã§â€œã‚µã‚¤ãƒˆã®å ã„â€ãŒå¤‰ã‚ã‚‹
// ãƒ»toneï¼ˆsoft/clear/bizï¼‰ã§è¨€ã„å›ã—ãŒå¤‰ã‚ã‚‹
// ãƒ»æ˜Ÿåº§ã¨æ•°ç§˜ã§ã€Œã‚¿ã‚¤ãƒ—ã€ã‚’é¸ã³ã€æ–‡ç« ã‚’ã¯ã‚è¾¼ã‚€
const TEXT_DB = {
  tones: {
    soft: {
      header: "ã“ã®é‘‘å®šã¯ã€æ˜Ÿåº§ãƒ»æ•°ç§˜ãƒ»ï¼ˆä»»æ„ã®ï¼‰å‡ºç”Ÿæƒ…å ±ã‚’ã‚‚ã¨ã«ã€å‚¾å‘ã¨ã—ã¦ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚",
      footer: "å ã„ã¯â€œä½¿ã†ã‚‚ã®â€ã€‚ä»Šæ—¥ã§ãã‚‹ä¸€æ­©ã«è½ã¨ã—è¾¼ã‚€ã»ã©ã€ç¾å®ŸãŒå‹•ãã‚„ã™ããªã‚Šã¾ã™ã€‚"
    },
    clear: {
      header: "ã“ã®é‘‘å®šã¯ã€æ˜Ÿåº§ãƒ»æ•°ç§˜ãƒ»ï¼ˆä»»æ„ã®ï¼‰å‡ºç”Ÿæƒ…å ±ã‹ã‚‰ã€å‚¾å‘ã‚’æ•´ç†ã—ãŸã‚‚ã®ã§ã™ã€‚",
      footer: "å ã„ã¯æ±ºå®šè¡¨ã§ã¯ãªãåœ°å›³ã€‚åˆã†è¡Œå‹•ã‚’é¸ã¹ã°ã€çµæœã¯å¤‰ãˆã‚‰ã‚Œã¾ã™ã€‚"
    },
    biz: {
      header: "ã“ã®é‘‘å®šã¯ã€æ˜Ÿåº§ãƒ»æ•°ç§˜ãƒ»ï¼ˆä»»æ„ã®ï¼‰å‡ºç”Ÿæƒ…å ±ã‚’ã‚‚ã¨ã«ã€è¡Œå‹•æŒ‡é‡ã«è½ã¨ã—ãŸã‚‚ã®ã§ã™ã€‚",
      footer: "é‹å‹¢ï¼ç’°å¢ƒÃ—é¸æŠÃ—ç¶™ç¶šã€‚å†ç¾æ€§ã®ã‚ã‚‹å‹•ãæ–¹ã«å¯„ã›ã‚‹ã»ã©ã€æˆæœãŒå‡ºã‚„ã™ããªã‚Šã¾ã™ã€‚"
    }
  },

  // æ˜Ÿåº§ã®ç‰¹å¾´ï¼ˆçŸ­æ–‡ï¼šæ”¹å¤‰ã—ã‚„ã™ã„ï¼‰
  signs: {
    "å±±ç¾Šåº§": { vibe: "å …å®Ÿãƒ»é•·æœŸå¿—å‘ãƒ»ç©ã¿ä¸Šã’" },
    "æ°´ç“¶åº§": { vibe: "ç‹¬è‡ªæ€§ãƒ»æ”¹é©ãƒ»ç™ºæƒ³" },
    "é­šåº§":   { vibe: "å…±æ„Ÿãƒ»æ„Ÿæ€§ãƒ»æµã‚Œ" },
    "ç‰¡ç¾Šåº§": { vibe: "å§‹å‹•ãƒ»ç›´æ„Ÿãƒ»çªç ´" },
    "ç‰¡ç‰›åº§": { vibe: "å®‰å®šãƒ»ä¾¡å€¤ãƒ»æŒä¹…åŠ›" },
    "åŒå­åº§": { vibe: "æƒ…å ±ãƒ»æ‹¡æ•£ãƒ»æŸ”è»Ÿ" },
    "èŸ¹åº§":   { vibe: "å®ˆã‚‹ãƒ»è‚²ã¦ã‚‹ãƒ»ã¤ãªãŒã‚Š" },
    "ç…å­åº§": { vibe: "è¡¨ç¾ãƒ»è‡ªä¿¡ãƒ»ä¸­å¿ƒ" },
    "ä¹™å¥³åº§": { vibe: "æ•´ç†ãƒ»æ”¹å–„ãƒ»å®Ÿå‹™" },
    "å¤©ç§¤åº§": { vibe: "èª¿å’Œãƒ»ç¾æ„è­˜ãƒ»äº¤æ¸‰" },
    "è åº§":   { vibe: "é›†ä¸­ãƒ»æ·±æ˜ã‚Šãƒ»æœ¬è³ª" },
    "å°„æ‰‹åº§": { vibe: "å†’é™ºãƒ»æ‹¡å¤§ãƒ»æ¢ç©¶" },
  },

  // æ•°ç§˜ï¼ˆãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ï¼‰ã®ç‰¹å¾´ï¼ˆçŸ­æ–‡ï¼‰
  lifepath: {
    1: "å§‹å‹•ã¨è‡ªå·±æ±ºå®š",
    2: "å”èª¿ã¨èª¿æ•´",
    3: "è¡¨ç¾ã¨ç™ºä¿¡",
    4: "åŸºç›¤ã¨ç¶™ç¶š",
    5: "å¤‰åŒ–ã¨æŒ‘æˆ¦",
    6: "æ„›æƒ…ã¨è²¬ä»»",
    7: "æ¢æ±‚ã¨å†…çœ",
    8: "é”æˆã¨æ‹¡å¤§",
    9: "å®Œæˆã¨å¾ªç’°",
  },

  // â€œå‹â€ã‚’3ç¨®ã ã‘ç”¨æ„ï¼šä¸‡äººå‘ã‘ã«ç ´ç¶»ã—ã«ãã„
  // ã“ã“ã‚’å¢—ã‚„ã›ã°ç²¾åº¦æ„Ÿã‚‚ä¸ŠãŒã‚‹
  archetypes: {
    A: {
      name: "å¾ŒåŠä¸Šæ˜‡ãƒ»å¤§å™¨æ™©æˆ",
      social: {
        title: "ğŸ§‘â€ğŸ¤â€ğŸ§‘ ç¤¾ä¼šã‚­ãƒ£ãƒ©",
        body: [
          "ç¬¬ä¸€å°è±¡ã¯è½ã¡ç€ãã¨èª å®Ÿã•ãŒå‡ºã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã€‚",
          "æ´¾æ‰‹ã«ç›®ç«‹ã¤ã‚ˆã‚Šã€ä¿¡é ¼ã®ç©ã¿é‡ã­ã§è©•ä¾¡ãŒä¸ŠãŒã‚‹ã€‚",
          "è·é›¢ãŒç¸®ã‚€ã»ã©é¢å€’è¦‹ãŒè‰¯ãã€è‡ªç„¶ã¨ã¾ã¨ã‚å½¹ã«ãªã‚Šã‚„ã™ã„ã€‚"
        ]
      },
      overall: {
        title: "ğŸŒ å…¨ä½“é‹",
        body: [
          "äººç”Ÿã¯å¾ŒåŠã»ã©æº€è¶³åº¦ãŒä¸ŠãŒã‚Šã‚„ã™ã„ã€‚",
          "åœŸå°ã¥ãã‚Šã®æœŸé–“ã‚’ä¸å¯§ã«éã”ã™ã»ã©ã€å¾Œã§å¤§ããå›åã—ã‚„ã™ã„ã€‚",
          "ç„¦ã‚Šã‚ˆã‚Šã‚‚ç¶™ç¶šãŒé‹å‹¢ã‚’å¼·ã‚ã‚‹ã€‚"
        ]
      },
      work: {
        title: "ğŸ’¼ ä»•äº‹é‹",
        body: [
          "ä¼ç”»ãƒ»è¡¨ç¾ãƒ»ç™ºä¿¡ãƒ»ãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚¹å¯„ã‚Šã§ä¼¸ã³ã‚„ã™ã„ã€‚",
          "å€‹äººè£é‡ãŒå¤§ãã„ã»ã©åŠ›ã‚’å‡ºã—ã‚„ã™ãã€ç©ã¿ä¸Šã’å‹ã§å¼·ããªã‚‹ã€‚",
          "åŸºç¤ã‚’ä½œã£ãŸã‚ã¨ã«è©•ä¾¡ãŒè¿½ã„ã¤ãã‚„ã™ã„ã€‚"
        ]
      },
      money: {
        title: "ğŸ’° é‡‘é‹",
        body: [
          "æ³¢ã¯å‡ºã‚„ã™ã„ãŒã€å›ååŠ›ãŒå¼·ã„ã€‚",
          "ç®¡ç†ï¼ˆå›ºå®šè²»ãƒ»ä»•çµ„ã¿åŒ–ï¼‰ã‚’æ•´ãˆã‚‹ã»ã©å®‰å®šã—ã‚„ã™ã„ã€‚",
          "é•·æœŸè¦–ç‚¹ã®è“„ç©ã¨ç›¸æ€§ãŒè‰¯ã„ã€‚"
        ]
      },
      health: {
        title: "ğŸ« å¥åº·é‹",
        body: [
          "ã‚¹ãƒˆãƒ¬ã‚¹ãŒæºœã¾ã‚‹ã¨ç¥çµŒãƒ»ç¡çœ ãƒªã‚ºãƒ ã«å‡ºã‚„ã™ã„ã€‚",
          "ä¼‘é¤Šã¯â€œè´…æ²¢â€ã§ã¯ãªãé‹å‹¢ç¶­æŒã®è¦ã€‚",
          "ç„¡ç†ã‚’æºœã‚ãªã„è¨­è¨ˆã«ã™ã‚‹ã¨é‹ãŒè½ã¡ã«ãã„ã€‚"
        ]
      },
      love: {
        title: "â¤ï¸ æ‹æ„›é‹",
        body: [
          "è»½ã„æ‹ã‚ˆã‚Šã€äººç”Ÿã‚’æ•´ãˆã‚‹é–¢ä¿‚ã«ç¸ãŒå‡ºã‚„ã™ã„ã€‚",
          "ä»•äº‹ã‚„ç”Ÿæ´»ã®å®‰å®šã¨æ‹æ„›é‹ãŒé€£å‹•ã—ã‚„ã™ã„ã€‚",
          "ç²¾ç¥çš„ã«è‡ªç«‹ã—ãŸç›¸æ‰‹ã¨ç›¸æ€§ãŒè‰¯ã„ã€‚"
        ]
      },
      turning: {
        title: "ğŸ§­ æµã‚Œã®åˆ‡ã‚Šæ›¿ã‚ã‚Š",
        body: [
          "åŸºç¤å·¥äº‹ â†’ è©•ä¾¡ãŒè¦‹ãˆã‚‹ â†’ å®‰å®šæ‹¡å¼µ â†’ å®Œæˆã€ã®é †ã§å¼·ããªã‚Šã‚„ã™ã„ã€‚",
          "â€œä¸€æ°—ã«å¤‰ãˆã‚‹â€ã‚ˆã‚Šã€â€œç©ã‚“ã§åŠ¹ã‹ã›ã‚‹â€æ–¹ãŒå‹ã¡ã‚„ã™ã„ã€‚"
        ]
      },
      final: {
        title: "ğŸ•Š æœ€çµ‚è©•ä¾¡",
        body: [
          "é™ã‹ã«ç©ã¿ä¸Šã’ã€å¾ŒåŠã§å¤§ããå ±ã‚ã‚Œã‚‹é…ç½®ã€‚",
          "æœ€çµ‚çš„ãªäººç”Ÿæº€è¶³åº¦ã‚’é«˜ã‚ã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã€‚"
        ]
      }
    },

    B: {
      name: "å®‰å®šæˆé•·ãƒ»å …å®Ÿç©ã¿ä¸Šã’",
      social: {
        title: "ğŸ§‘â€ğŸ¤â€ğŸ§‘ ç¤¾ä¼šã‚­ãƒ£ãƒ©",
        body: [
          "ç©ã‚„ã‹ã§ä¿¡é ¼ã•ã‚Œã‚„ã™ã„å°è±¡ãŒå‡ºã‚„ã™ã„ã€‚",
          "ç´„æŸã‚’å®ˆã‚‹ãƒ»ç¶™ç¶šã™ã‚‹ã“ã¨ã§è©•ä¾¡ãŒå›ºã¾ã‚‹ã€‚",
          "èª¿æ•´å½¹ãƒ»å®Ÿå‹™ã§é ¼ã‚‰ã‚Œã‚„ã™ã„ã€‚"
        ]
      },
      overall: {
        title: "ğŸŒ å…¨ä½“é‹",
        body: [
          "å¤§æ³¢ä¹±ã¯å°‘ãªãã€å®‰å®šã—ã¦ç©ã¿ä¸ŠãŒã‚Šã‚„ã™ã„ã€‚",
          "ç”Ÿæ´»åŸºç›¤ãŒæ•´ã†ã»ã©é‹ãŒå¼·ããªã‚‹ã€‚",
          "é•·æœŸçš„ãªå®‰å¿ƒæ„Ÿã‚’ä½œã‚‹ã®ãŒå¾—æ„ã€‚"
        ]
      },
      work: {
        title: "ğŸ’¼ ä»•äº‹é‹",
        body: [
          "ç®¡ç†ãƒ»èª¿æ•´ãƒ»å®Ÿå‹™ã®è»¸ã§è©•ä¾¡ãŒä¸ŠãŒã‚‹ã€‚",
          "è²¬ä»»ã‚ã‚‹å½¹å‰²ã»ã©ä¿¡é ¼ãŒç©ã‚‚ã‚‹ã€‚",
          "ã‚³ãƒ„ã‚³ãƒ„å‹ã®æˆæœãŒå¾Œã§å¤§ããåŠ¹ãã€‚"
        ]
      },
      money: {
        title: "ğŸ’° é‡‘é‹",
        body: [
          "è“„ç©å‹ã§ã€å®ˆã‚ŠãŒå¼·ã„ã€‚",
          "å›ºå®šè²»ã®æœ€é©åŒ–ãŒä¸€ç•ªåŠ¹ãã€‚",
          "ä¸€æ”«åƒé‡‘ã‚ˆã‚Šã€å …å®Ÿãªå¢—ã‚„ã—æ–¹ãŒå‘ãã€‚"
        ]
      },
      health: {
        title: "ğŸ« å¥åº·é‹",
        body: [
          "ç–²åŠ´ãŒç¡çœ ã«å‡ºã‚„ã™ã„ã€‚",
          "ä¼‘ã‚€ã®ãŒä¸‹æ‰‹ã ã¨å¾Œã§éŸ¿ãã®ã§ã€ä¼‘é¤Šã¯ä»•çµ„ã¿åŒ–ã™ã‚‹ã¨è‰¯ã„ã€‚",
          "ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ãŒå¥åº·é‹ã‚’åº•ä¸Šã’ã™ã‚‹ã€‚"
        ]
      },
      love: {
        title: "â¤ï¸ æ‹æ„›é‹",
        body: [
          "é•·æœŸå®‰å®šã®æ‹æ„›ã«å¼·ã„ã€‚",
          "é–¢ä¿‚ãŒè‚²ã¤ã»ã©å®‰å¿ƒæ„ŸãŒå¢—ã™ã€‚",
          "å®¶åº­é‹ãŒäººç”Ÿã®åŸºç›¤ã«ãªã‚Šã‚„ã™ã„ã€‚"
        ]
      },
      turning: {
        title: "ğŸ§­ æµã‚Œã®åˆ‡ã‚Šæ›¿ã‚ã‚Š",
        body: [
          "å®‰å®š â†’ å½¹å‰²å¢— â†’ ä¿¡é ¼å›ºå®š â†’ ç”Ÿæ´»å®Œæˆã€ã®é †ã§è‰¯ããªã‚‹ã€‚",
          "å¤§å‹è² ã‚ˆã‚Šã€è‰¯ã„ç¿’æ…£ã®ç©ã¿ä¸Šã’ãŒé‹ã‚’ä¸Šã’ã‚‹ã€‚"
        ]
      },
      final: {
        title: "ğŸ•Š æœ€çµ‚è©•ä¾¡",
        body: [
          "é•·æœŸçš„ãªå®‰å®šã¨æº€è¶³ã‚’ä½œã‚Šã‚„ã™ã„é…ç½®ã€‚",
          "äººç”Ÿå…¨ä½“ã®å®‰å¿ƒæ„ŸãŒå¢—ãˆã¦ã„ãã‚¿ã‚¤ãƒ—ã€‚"
        ]
      }
    },

    C: {
      name: "å¤‰åŒ–é©å¿œãƒ»æŒ‘æˆ¦ã§ä¼¸ã³ã‚‹",
      social: {
        title: "ğŸ§‘â€ğŸ¤â€ğŸ§‘ ç¤¾ä¼šã‚­ãƒ£ãƒ©",
        body: [
          "è©±é¡Œæ€§ãƒ»è¡Œå‹•åŠ›ãŒè©•ä¾¡ã•ã‚Œã‚„ã™ã„ã€‚",
          "æ–°ã—ã„å ´æ‰€ã§ä¼¸ã³ã‚‹ã‚¿ã‚¤ãƒ—ã€‚",
          "å¤‰åŒ–ãŒã‚ã‚‹ã»ã©é­…åŠ›ãŒå‡ºã‚‹ã€‚"
        ]
      },
      overall: {
        title: "ğŸŒ å…¨ä½“é‹",
        body: [
          "åœæ»ã‚ˆã‚Šã€å¤‰åŒ–ã§é‹ãŒå‹•ãã€‚",
          "æ–°è¦æŒ‘æˆ¦ã®æ•°ãŒæœªæ¥ã‚’ä½œã‚Šã‚„ã™ã„ã€‚",
          "æŸ”è»Ÿãªåˆ‡ã‚Šæ›¿ãˆãŒå¼·ã¿ã€‚"
        ]
      },
      work: {
        title: "ğŸ’¼ ä»•äº‹é‹",
        body: [
          "æ–°è¦ãƒ»ä¼ç”»ãƒ»æ‹¡å¼µã«å¼·ã„ã€‚",
          "å˜èª¿ã•ã‚ˆã‚Šã€å¤‰åŒ–ã®ã‚ã‚‹ç’°å¢ƒãŒåˆã†ã€‚",
          "å‹•ããªãŒã‚‰æ•´ãˆã‚‹ã¨æˆæœãŒå‡ºã‚„ã™ã„ã€‚"
        ]
      },
      money: {
        title: "ğŸ’° é‡‘é‹",
        body: [
          "åå…¥æºã‚’è¤‡ç·šåŒ–ã™ã‚‹ã¨å¼·ã„ã€‚",
          "å‹¢ã„ã§å¢—ãˆã‚‹ãŒã€ç®¡ç†ãŒå¼±ã„ã¨æ¸›ã‚Šã‚„ã™ã„ã€‚",
          "ä»•çµ„ã¿åŒ–ãŒå®‰å®šã®éµã€‚"
        ]
      },
      health: {
        title: "ğŸ« å¥åº·é‹",
        body: [
          "ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®ä¸Šä¸‹ãŒä½“ã«å‡ºã‚„ã™ã„ã€‚",
          "ç¡çœ ã¨é£Ÿäº‹ã®å›ºå®šãŒé‹ã®åœŸå°ã€‚",
          "â€œä¼‘ã‚€æ—¥ã‚’æ±ºã‚ã‚‹â€ã¨å®‰å®šã™ã‚‹ã€‚"
        ]
      },
      love: {
        title: "â¤ï¸ æ‹æ„›é‹",
        body: [
          "å‡ºä¼šã„ãŒå¤šãã€å‹•ãã»ã©ç¸ãŒå¢—ãˆã‚‹ã€‚",
          "å‹¢ã„ã§æ±ºã‚ã™ããªã„è¦‹æ¥µã‚ãŒå¤§äº‹ã€‚",
          "ç›¸æ‰‹ã¨æœªæ¥è¨­è¨ˆã§ãã‚‹ã¨å¼·ã„ã€‚"
        ]
      },
      turning: {
        title: "ğŸ§­ æµã‚Œã®åˆ‡ã‚Šæ›¿ã‚ã‚Š",
        body: [
          "æŒ‘æˆ¦ â†’ é©å¿œ â†’ ä»•çµ„ã¿åŒ– â†’ å®‰å®šã€ã®é †ã§å¼·ããªã‚‹ã€‚",
          "æŒ‘æˆ¦ãŒæ­¢ã¾ã‚‹ã¨é‹ã‚‚æ­¢ã¾ã‚Šã‚„ã™ã„ã€‚"
        ]
      },
      final: {
        title: "ğŸ•Š æœ€çµ‚è©•ä¾¡",
        body: [
          "å¤‰åŒ–ã‚’å‘³æ–¹ã«ã¤ã‘ã‚‹ã»ã©ä¸ŠãŒã‚‹é…ç½®ã€‚",
          "æŒ‘æˆ¦ã®æ•°ãŒäººç”Ÿã®åšã¿ã«ãªã‚‹ã‚¿ã‚¤ãƒ—ã€‚"
        ]
      }
    }
  }
};

/* =========================================================================
  1) è¨ˆç®—ç³»ï¼šæ•°ç§˜ãƒ»æ˜Ÿåº§ãƒ»å¹´é½¢
============================================================================ */

function calcLifePathNumber(dateObj) {
  // YYYYMMDDã®åˆè¨ˆã‚’1æ¡ã«ã™ã‚‹ï¼ˆç°¡æ˜“æ•°ç§˜ï¼‰
  const y = String(dateObj.getFullYear());
  const m = String(dateObj.getMonth() + 1).padStart(2, "0");
  const d = String(dateObj.getDate()).padStart(2, "0");
  const s = y + m + d;

  let sum = 0;
  for (const ch of s) sum += Number(ch);
  while (sum > 9) sum = String(sum).split("").reduce((a,c)=>a+Number(c),0);
  return sum; // 1-9
}

function calcAge(dateObj, yearNow = CONFIG.yearNow) {
  // yearNow ã®èª•ç”Ÿæ—¥æ™‚ç‚¹ã®å¹´é½¢ï¼ˆã–ã£ãã‚Šï¼‰
  const today = new Date(yearNow, 0, 1);
  let age = yearNow - dateObj.getFullYear();
  const birthdayThisYear = new Date(yearNow, dateObj.getMonth(), dateObj.getDate());
  if (today < birthdayThisYear) age -= 1;
  return age;
}

function calcZodiacSign(dateObj) {
  const m = dateObj.getMonth() + 1;
  const d = dateObj.getDate();

  // è¥¿æ´‹æ˜Ÿåº§ï¼ˆå¤ªé™½æ˜Ÿåº§ï¼‰ã®å¢ƒç•Œï¼ˆä¸€èˆ¬çš„ï¼‰
  if ((m==1 && d>=20) || (m==2 && d<=18)) return "æ°´ç“¶åº§";
  if ((m==2 && d>=19) || (m==3 && d<=20)) return "é­šåº§";
  if ((m==3 && d>=21) || (m==4 && d<=19)) return "ç‰¡ç¾Šåº§";
  if ((m==4 && d>=20) || (m==5 && d<=20)) return "ç‰¡ç‰›åº§";
  if ((m==5 && d>=21) || (m==6 && d<=21)) return "åŒå­åº§";
  if ((m==6 && d>=22) || (m==7 && d<=22)) return "èŸ¹åº§";
  if ((m==7 && d>=23) || (m==8 && d<=22)) return "ç…å­åº§";
  if ((m==8 && d>=23) || (m==9 && d<=22)) return "ä¹™å¥³åº§";
  if ((m==9 && d>=23) || (m==10 && d<=23)) return "å¤©ç§¤åº§";
  if ((m==10 && d>=24) || (m==11 && d<=22)) return "è åº§";
  if ((m==11 && d>=23) || (m==12 && d<=21)) return "å°„æ‰‹åº§";
  return "å±±ç¾Šåº§"; // (12/22-1/19)
}

/* =========================================================================
  2) â€œå‹â€ã®æ±ºå®šï¼šä¸‡äººå‘ã‘ã«ç ´ç¶»ã—ã«ãã„ãƒ«ãƒ¼ãƒ«
     â€»æœ¬æ ¼é‘‘å®šã§ã¯ãªã„ã€‚ã‚µã‚¤ãƒˆã®æ±ç”¨æ€§å„ªå…ˆã€‚
============================================================================ */

function pickArchetype({ sign, lifepath }) {
  // ã–ã£ãã‚Šãƒ«ãƒ¼ãƒ«ï¼š
  // ãƒ»4,8 ã¯ç©ã¿ä¸Šã’ã‚„ã™ã„ â†’ A or B
  // ãƒ»5 ã¯å¤‰åŒ– â†’ C
  // ãƒ»7 ã¯å¾ŒåŠä¼¸ã³ â†’ A
  // ãƒ»å±±ç¾Š/ä¹™å¥³/ç‰¡ç‰› ã¯å …å®Ÿ â†’ Bå¯„ã‚Š
  // ãƒ»ç…å­/ç‰¡ç¾Š/å°„æ‰‹ ã¯å‹•ã â†’ Cå¯„ã‚Š
  if (lifepath === 5) return "C";
  if (lifepath === 7) return "A";
  if (["å±±ç¾Šåº§","ä¹™å¥³åº§","ç‰¡ç‰›åº§"].includes(sign)) return (lifepath === 4 || lifepath === 8) ? "A" : "B";
  if (["ç…å­åº§","ç‰¡ç¾Šåº§","å°„æ‰‹åº§"].includes(sign)) return "C";
  if (lifepath === 4 || lifepath === 8) return "A";
  return "B";
}

/* =========================================================================
  3) å‡ºåŠ›ç”Ÿæˆï¼šãƒ†ã‚­ã‚¹ãƒˆçµ„ã¿ç«‹ã¦ï¼ˆåˆå¿ƒè€…å‘ã‘ã«ã‚·ãƒ³ãƒ—ãƒ«ï¼‰
============================================================================ */

function formatDateJP(dateObj) {
  const y = dateObj.getFullYear();
  const m = String(dateObj.getMonth()+1).padStart(2,"0");
  const d = String(dateObj.getDate()).padStart(2,"0");
  return `${y}/${m}/${d}`;
}

function joinLines(arr) {
  return arr.map(s => `ãƒ»${s}`).join("\n");
}

function buildReading({ name, place, dobStr, timeStr, tone }) {
  const birth = new Date(dobStr);
  const lp = calcLifePathNumber(birth);
  const sign = calcZodiacSign(birth);
  const age = calcAge(birth, CONFIG.yearNow);

  const archKey = pickArchetype({ sign, lifepath: lp });
  const arch = TEXT_DB.archetypes[archKey];

  const tonePack = TEXT_DB.tones[tone] ?? TEXT_DB.tones.soft;
  const signVibe = TEXT_DB.signs[sign]?.vibe ?? "";
  const lpVibe = TEXT_DB.lifepath[lp] ?? "";

  // ãƒãƒƒã‚¸è¡¨ç¤º
  document.getElementById("badgeSign").textContent = `${sign}ï¼ˆ${signVibe}ï¼‰`;
  document.getElementById("badgeLP").textContent = `${lp}ï¼ˆ${lpVibe}ï¼‰`;
  document.getElementById("badgeAge").textContent = `${CONFIG.yearNow}å¹´æ™‚ç‚¹ï¼š${age}æ­³ç›®å®‰`;

  const lines = [];
  lines.push(`# ğŸ”® ç·åˆé‘‘å®šï¼š**${(name || "ï¼ˆåå‰æœªå…¥åŠ›ï¼‰")}**`);
  lines.push("");
  lines.push(`ç”Ÿå¹´æœˆæ—¥ï¼š${formatDateJP(birth)}`);
  lines.push(`å‡ºç”Ÿåœ°ï¼š${place || "ï¼ˆæœªå…¥åŠ›ï¼‰"}`);
  lines.push(`å‡ºç”Ÿæ™‚é–“ï¼š${(timeStr && timeStr.trim()) ? timeStr.trim() : "ä¸æ˜"}`);
  lines.push(`æ˜Ÿåº§ï¼š${sign}ï¼ˆ${signVibe}ï¼‰`);
  lines.push(`æ•°ç§˜ï¼š${lp}ï¼ˆ${lpVibe}ï¼‰`);
  lines.push(`é‘‘å®šã‚¿ã‚¤ãƒ—ï¼š${arch.name}ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ï¼‰`);
  lines.push("");
  lines.push(tonePack.header);
  lines.push("");

  // ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‡ºåŠ›ï¼ˆCONFIG.sections ã®é †ã§ï¼‰
  for (const key of CONFIG.sections) {
    const sec = arch[key];
    if (!sec) continue;
    lines.push(`## ${sec.title}`);
    lines.push(joinLines(sec.body));
    lines.push("");
  }

  lines.push(tonePack.footer);
  return lines.join("\n");
}

/* =========================================================================
  4) UI
============================================================================ */

const $ = (id) => document.getElementById(id);

$("gen").addEventListener("click", () => {
  const dob = $("dob").value;
  if (!dob) {
    alert("ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ã­");
    return;
  }

  const result = buildReading({
    name: $("name").value,
    place: $("place").value,
    dobStr: dob,
    timeStr: $("time").value,
    tone: $("tone").value
  });

  $("out").value = result;
});

$("copy").addEventListener("click", async () => {
  const text = $("out").value;
  if (!text.trim()) return alert("å…ˆã«ç”Ÿæˆã—ã¦ã­");
  await navigator.clipboard.writeText(text);
  alert("ã‚³ãƒ”ãƒ¼ã—ãŸã‚ˆ");
});

$("clear").addEventListener("click", () => {
  $("name").value = "";
  $("place").value = "";
  $("dob").value = "";
  $("time").value = "";
  $("out").value = "";
  $("badgeSign").textContent = "-";
  $("badgeLP").textContent = "-";
  $("badgeAge").textContent = "-";
});
</script>
</body>
</html>
