<!-- Version: 3  /  2026-01-04
  ============================================================
  âœ… å…¬é–‹ç”¨ï¼ˆç”»é¢ã¯ã‚¹ãƒƒã‚­ãƒªï¼‰ï¼‹ âœ… é–‹ç™ºè€…ãƒ¡ãƒ¢å¤šã‚ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰

  â–¼ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½¿ã„æ–¹
  - GitHub Pagesã«ç½®ããªã‚‰ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯ index.html ã«ã™ã‚‹ã®ãŒä¸€ç•ªãƒ©ã‚¯ã€‚
  - 1ãƒ•ã‚¡ã‚¤ãƒ«å®Œçµï¼ˆHTML/CSS/JSå…¨éƒ¨å…¥ã‚Šï¼‰

  â–¼ è§¦ã£ã¦OKãªå ´æ‰€ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰
  1) CSSã® :rootï¼ˆè‰²/è§’ä¸¸/ä½™ç™½/ãƒ•ã‚©ãƒ³ãƒˆï¼‰
  2) CONFIGï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³é †ã‚„è¡¨ç¤ºON/OFFï¼‰
  3) TEXT_DB
     - tonesï¼šã‚„ã•ã—ã‚/æ¨™æº–/æ¯’èˆŒã®æ–‡ç« 
     - kumaTypeSeedsï¼š20ã‚¿ã‚¤ãƒ—ã®åå‰ã‚„èª¬æ˜ã®ææ–™
     - archetypesï¼šè©³ç´°é‘‘å®šï¼ˆA/B/Cï¼‰ã®æœ¬æ–‡

  â–¼ ä»Šã®ä»•æ§˜
  - å‡ºç”Ÿåœ°(place)ã€å‡ºç”Ÿæ™‚é–“(time)ã¯ã€Œè¡¨ç¤ºã«å‡ºã™ã ã‘ã€
  - å°†æ¥ã€ãƒ­ã‚¸ãƒƒã‚¯ã«çµ„ã¿è¾¼ã‚€ä½™åœ°ã‚’æ®‹ã—ã¦ã„ã‚‹ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå‚ç…§ï¼‰

  â–¼ ç”»é¢ã«å‡ºã•ãªã„ã‚‚ã®
  - ã€Œãƒ†ãƒ³ãƒ—ãƒ¬ã€ã€Œæœªæ­è¼‰ã€ãªã©é–‹ç™ºè€…å‘ã‘æ³¨é‡ˆã¯è¡¨ç¤ºã—ãªã„
  ============================================================
-->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ã‚¯ãƒå ã„</title>

  <style>
    /* =========================================================
      âœ… åˆå¿ƒè€…ãŒè§¦ã£ã¦OKï¼šãƒ‡ã‚¶ã‚¤ãƒ³èª¿æ•´ã¯ã“ã“ã ã‘ã§OK
    ========================================================= */
    :root{
      --bg:#0b0b10;
      --panel:#11111a;
      --text:#f3f3f7;
      --muted:rgba(243,243,247,.72);
      --line:rgba(255,255,255,.12);
      --accent:#8ab4ff;

      --radius:14px;
      --pad:16px;
      --gap:12px;
      --shadow:0 10px 30px rgba(0,0,0,.35);

      --max:980px;
      --font:system-ui,-apple-system,"Hiragino Sans","Noto Sans JP",sans-serif;
      --mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Noto Sans Mono",monospace;
    }

    *,*::before,*::after{ box-sizing:border-box; }
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 15% 0%, rgba(138,180,255,.18), transparent 55%),
        radial-gradient(900px 500px at 90% 10%, rgba(255,140,180,.12), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family:var(--font);
      line-height:1.7;
    }

    .wrap{ max-width:var(--max); margin:0 auto; padding:24px; }
    header{ display:flex; flex-direction:column; gap:6px; margin-bottom:16px; }
    h1{ font-size:20px; margin:0; }
    .sub{ margin:0; color:var(--muted); font-size:13px; }

    .grid{ display:grid; grid-template-columns:1fr; gap:var(--gap); align-items:start; }
    @media (min-width:900px){ .grid{ grid-template-columns:360px 1fr; } }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.04), transparent 42%), var(--panel);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:var(--pad);
      box-shadow:var(--shadow);
    }

    .sectionTitle{ font-size:13px; color:var(--muted); margin:0 0 10px; letter-spacing:.02em; }

    label{ display:block; font-size:12px; color:var(--muted); margin:10px 0 6px; }
    input,select{
      width:100%;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      outline:none;
      font-size:14px;
    }
    input::placeholder{ color:rgba(255,255,255,.35); }

    .row2{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    @media (max-width:560px){ .row2{ grid-template-columns:1fr; } .wrap{ padding:16px; } }

    .btns{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    button{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      cursor:pointer;
      font-size:14px;
    }
    button.primary{
      background:var(--accent);
      border-color:transparent;
      color:#09101d;
      font-weight:800;
    }
    button:active{ transform:translateY(1px); }

    .pill{
      display:inline-block;
      padding:4px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      color:var(--muted);
      font-size:12px;
      margin-right:6px;
      background:rgba(255,255,255,.03);
    }
    .mini{ font-size:12px; color:var(--muted); }

    .typeBox{
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:12px;
      background:rgba(255,255,255,.03);
      margin-top:10px;
    }
    .typeTitle{ font-weight:900; font-size:16px; margin:0 0 6px; }
    .typeDesc{ margin:0; color:var(--muted); font-size:13px; }
    .typeMeta{ margin-top:8px; color:var(--muted); font-size:12px; }

    textarea{
      width:100%;
      min-height:520px;
      border-radius:var(--radius);
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--text);
      padding:12px;
      font-family:var(--mono);
      font-size:13px;
      white-space:pre-wrap;
      line-height:1.65;
    }
  </style>
</head>

<body>
<div class="wrap">
  <header>
    <h1>ã‚¯ãƒå ã„</h1>
    <p class="sub">ã‚¿ã‚¤ãƒ—å®£è¨€ â†’ è©³ç´°é‘‘å®šï¼ˆãƒœã‚¿ãƒ³1å›ï¼‰</p>
  </header>

  <div class="grid">

    <!-- =========================================================
      å…¥åŠ›ã‚«ãƒ¼ãƒ‰
      â€»ç”»é¢ã«ã€Œé–‹ç™ºè€…æ³¨é‡ˆã€ã¯å‡ºã•ãªã„ï¼ˆã‚³ãƒ¼ãƒ‰å†…ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ï¼‰
    ========================================================== -->
    <div class="card">
      <p class="sectionTitle">å…¥åŠ›</p>

      <label>åå‰</label>
      <input id="name" placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒ" />

      <label>ç”Ÿå¹´æœˆæ—¥</label>
      <input id="dob" type="date" />

      <div class="row2">
        <div>
          <label>å‡ºç”Ÿåœ°</label>
          <select id="place"></select>
        </div>
        <div>
          <label>å‡ºç”Ÿæ™‚é–“</label>
          <select id="time"></select>
        </div>
      </div>

      <label>é‘‘å®šã‚¹ã‚¿ã‚¤ãƒ«</label>
      <select id="tone">
        <option value="soft">ã‚„ã•ã—ã‚</option>
        <option value="normal" selected>æ¨™æº–</option>
        <option value="spicy">æ¯’èˆŒ</option>
      </select>

      <div class="btns">
        <button class="primary" id="gen">ç”Ÿæˆ</button>
        <button id="copy">ã‚³ãƒ”ãƒ¼</button>
        <button id="clear">ã‚¯ãƒªã‚¢</button>
      </div>
    </div>

    <!-- =========================================================
      å‡ºåŠ›ã‚«ãƒ¼ãƒ‰ï¼ˆå…¬é–‹ç”¨ã«ã‚¹ãƒƒã‚­ãƒªï¼‰
    ========================================================== -->
    <div class="card" id="outputCard">
      <p class="sectionTitle">çµæœ</p>

      <div class="mini">
        <span class="pill">æ˜Ÿåº§</span><span id="badgeSign">-</span>
        <span class="pill">æ•°ç§˜</span><span id="badgeLP">-</span>
        <span class="pill">å¹´é½¢</span><span id="badgeAge">-</span>
      </div>

      <div class="typeBox">
        <p class="typeTitle" id="typeTitle">ã‚¿ã‚¤ãƒ—ï¼š-</p>
        <p class="typeDesc" id="typeDesc">ç”Ÿå¹´æœˆæ—¥ã‚’å…¥ã‚Œã¦ã€Œç”Ÿæˆã€ã‚’æŠ¼ã—ã¦ã­ã€‚</p>
        <div class="typeMeta" id="typeMeta">-</div>
      </div>

      <label style="margin-top:12px;">é‘‘å®šæ–‡</label>
      <textarea id="out" readonly></textarea>
    </div>

  </div>
</div>

<script>
/* =========================================================
  âœ… åˆå¿ƒè€…ãŒè§¦ã£ã¦OKï¼šCONFIG
  - sectionsï¼šè©³ç´°é‘‘å®šã®è¡¨ç¤ºé †ï¼ˆå…¥ã‚Œæ›¿ãˆOKï¼‰
  - showMetaï¼šæœ¬æ–‡ã«ã€Œå‡ºç”Ÿåœ°/å‡ºç”Ÿæ™‚é–“ã€ã‚’è¼‰ã›ã‚‹ã‹ï¼ˆON/OFFï¼‰
========================================================= */
const CONFIG = {
  sections: ["social","overall","work","money","health","love","turning","final"],
  showMeta: true, // falseã«ã™ã‚‹ã¨æœ¬æ–‡ã‹ã‚‰ã€Œå‡ºç”Ÿåœ°/å‡ºç”Ÿæ™‚é–“ã€ã‚’æ¶ˆã›ã‚‹
};

/* =========================================================
  âœ… åˆå¿ƒè€…ãŒè§¦ã£ã¦OKï¼šTEXT_DB
  - tonesï¼šã‚„ã•ã—ã‚/æ¨™æº–/æ¯’èˆŒã®æ–‡ç« 
  - kumaTypeSeedsï¼š20ã‚¿ã‚¤ãƒ—å‘½åã®ææ–™ï¼ˆå¾Œã§â€œå®Œå…¨æ‰‹æ‰“ã¡20å€‹â€ã«ã‚‚ã§ãã‚‹ï¼‰
  - archetypesï¼šè©³ç´°é‘‘å®šï¼ˆã¾ãšã¯A/B/Cã§å®‰å®šé‹ç”¨ï¼‰
========================================================= */
const TEXT_DB = {
  tones: {
    soft: {
      header: "ä»Šæ—¥ã¯ã‚ãªãŸã®è‰¯ã•ã¨å¯èƒ½æ€§ã«å…‰ã‚’å½“ã¦ã¦ã€ã‚„ã•ã—ãèª­ã¿è§£ã„ã¦ã„ãã­ã€‚",
      footer: "ç„¦ã‚‰ãªãã¦å¤§ä¸ˆå¤«ã€‚å°ã•ãªä¸€æ­©ã‚’ç©ã¿é‡ã­ã‚‹ã»ã©ã€é‹ã¯ã‚ãªãŸã®å‘³æ–¹ã«ãªã£ã¦ã„ãã‚ˆã€‚",
      line: (s) => `${stripPeriod(s)}ã€‚ã‚ãªãŸãªã‚‰ã¡ã‚ƒã‚“ã¨å½¢ã«ã§ãã‚‹ã‚ˆã€‚`
    },
    normal: {
      header: "ã“ã®é‘‘å®šã¯ã€æ˜Ÿåº§ãƒ»æ•°ç§˜ãªã©ã‹ã‚‰èª­ã¿å–ã‚Œã‚‹å‚¾å‘ã‚’å®¢è¦³çš„ã«ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚",
      footer: "é‹å‹¢ã¯åœ°å›³ã®ã‚ˆã†ãªã‚‚ã®ã€‚ä½¿ã„æ–¹æ¬¡ç¬¬ã§ã€è¡Œãå…ˆã¯ã„ãã‚‰ã§ã‚‚å¤‰ãˆã‚‰ã‚Œã¾ã™ã€‚",
      line: (s) => s
    },
    spicy: {
      header: "é æ…®ãªã—ã§è¨€ã†ã€‚ã“ã“ã‹ã‚‰å…ˆã¯ç”˜ããªã„ã€‚ã§ã‚‚ã€ä¼¸ã³ã‚‹ãŸã‚ã«å¿…è¦ãªè©±ã ã‘æ›¸ãã€‚",
      footer: "åˆºã•ã£ãŸãªã‚‰ä¼¸ã³ã—ã‚ã€‚ä»Šæ—¥ã‹ã‚‰ä¸€å€‹ã ã‘ç›´ã›ã°ã€é‹ã¯æ™®é€šã«ä¸ŠãŒã‚‹ã€‚ã‚„ã‚‹ã‹ã©ã†ã‹ã¯ã‚ãªãŸæ¬¡ç¬¬ã€‚",
      line: (s) => `${stripPeriod(s)}ã€‚${pickOne([
        "â€¦ã§ã€ã„ã¤ã‚„ã‚‹ã®ï¼Ÿ",
        "è¨€ã„è¨³ã—ã¦ã‚‹æš‡ã‚ã‚‹ï¼Ÿ",
        "ã“ã“ã§æ­¢ã¾ã‚‹ã¨é‹ã‚‚æ­¢ã¾ã‚‹ã€‚",
        "ã‚„ã‚‹äººã ã‘ãŒå›åã™ã‚‹ã€‚"
      ])}`
    }
  },

  signs: {
    "å±±ç¾Šåº§": { vibe: "å …å®Ÿãƒ»é•·æœŸå¿—å‘ãƒ»ç©ã¿ä¸Šã’" },
    "æ°´ç“¶åº§": { vibe: "ç‹¬è‡ªæ€§ãƒ»æ”¹é©ãƒ»ç™ºæƒ³" },
    "é­šåº§":   { vibe: "å…±æ„Ÿãƒ»æ„Ÿæ€§ãƒ»æµã‚Œ" },
    "ç‰¡ç¾Šåº§": { vibe: "å§‹å‹•ãƒ»ç›´æ„Ÿãƒ»çªç ´" },
    "ç‰¡ç‰›åº§": { vibe: "å®‰å®šãƒ»ä¾¡å€¤ãƒ»æŒä¹…åŠ›" },
    "åŒå­åº§": { vibe: "æƒ…å ±ãƒ»æ‹¡æ•£ãƒ»æŸ”è»Ÿ" },
    "èŸ¹åº§":   { vibe: "å®ˆã‚‹ãƒ»è‚²ã¦ã‚‹ãƒ»ã¤ãªãŒã‚Š" },
    "ç…å­åº§": { vibe: "è¡¨ç¾ãƒ»è‡ªä¿¡ãƒ»ä¸­å¿ƒ" },
    "ä¹™å¥³åº§": { vibe: "æ•´ç†ãƒ»æ”¹å–„ãƒ»å®Ÿå‹™" },
    "å¤©ç§¤åº§": { vibe: "èª¿å’Œãƒ»ç¾æ„è­˜ãƒ»äº¤æ¸‰" },
    "è åº§":   { vibe: "é›†ä¸­ãƒ»æ·±æ˜ã‚Šãƒ»æœ¬è³ª" },
    "å°„æ‰‹åº§": { vibe: "å†’é™ºãƒ»æ‹¡å¤§ãƒ»æ¢ç©¶" },
  },

  lifepath: {
    1:"å§‹å‹•ã¨è‡ªå·±æ±ºå®š", 2:"å”èª¿ã¨èª¿æ•´", 3:"è¡¨ç¾ã¨ç™ºä¿¡",
    4:"åŸºç›¤ã¨ç¶™ç¶š", 5:"å¤‰åŒ–ã¨æŒ‘æˆ¦", 6:"æ„›æƒ…ã¨è²¬ä»»",
    7:"æ¢æ±‚ã¨å†…çœ", 8:"é”æˆã¨æ‹¡å¤§", 9:"å®Œæˆã¨å¾ªç’°"
  },

  /* âœ…20ã‚¿ã‚¤ãƒ—å‘½åã®ææ–™ï¼ˆã“ã“ã‚’å¤‰ãˆã‚‹ã¨ã‚¿ã‚¤ãƒ—å/èª¬æ˜ãŒå¤‰ã‚ã‚‹ï¼‰ */
  kumaTypeSeeds: {
    elements: [
      { key:"FIRE",  name:"ç«",  vibe:"å‹¢ã„ã¨çªç ´" },
      { key:"EARTH", name:"åœ°",  vibe:"å …å®Ÿã¨ç©ã¿ä¸Šã’" },
      { key:"AIR",   name:"é¢¨",  vibe:"ç™ºæƒ³ã¨è»½ã‚„ã‹ã•" },
      { key:"WATER", name:"æ°´",  vibe:"å…±æ„Ÿã¨æ·±ã¿" },
    ],
    buckets: [
      { idx:1, name:"å®‰å®š", desc:"ç”Ÿæ´»ã¨åœŸå°ã‚’æ•´ãˆã‚‹ã»ã©é‹ãŒå¼·ã„" },
      { idx:2, name:"ä¼¸é•·", desc:"ã‚³ãƒ„ã‚³ãƒ„æˆé•·ã—ã¦è©•ä¾¡ã‚’ç©ã‚€" },
      { idx:3, name:"æŒ‘æˆ¦", desc:"å‹•ã„ãŸã¶ã‚“ã ã‘é‹ãŒå‹•ã" },
      { idx:4, name:"æ¢æ±‚", desc:"æ·±æ˜ã‚Šã§ç²¾åº¦ãŒä¸ŠãŒã‚‹" },
      { idx:5, name:"å®Œæˆ", desc:"æ•´ç†ã¨æ‰‹æ”¾ã—ã§ä¸€æ®µä¸Šã«è¡Œã" },
    ],
  },

  /* âœ…è©³ç´°æœ¬æ–‡ï¼šA/B/Cï¼ˆã¾ãšã¯ç ´ç¶»ã—ã«ãã„3æœ¬ã§é‹ç”¨ï¼‰ */
  archetypes: {
    A: {
      name: "å¾ŒåŠä¸Šæ˜‡ãƒ»å¤§å™¨æ™©æˆ",
      social:{title:"ğŸ§‘â€ğŸ¤â€ğŸ§‘ ç¤¾ä¼šã‚­ãƒ£ãƒ©", body:[
        "ç¬¬ä¸€å°è±¡ã¯è½ã¡ç€ãã¨èª å®Ÿã•ãŒå‡ºã‚„ã™ã„ã€‚",
        "æ´¾æ‰‹ã«ç›®ç«‹ã¤ã‚ˆã‚Šã€ä¿¡é ¼ã®ç©ã¿é‡ã­ã§è©•ä¾¡ãŒä¸ŠãŒã‚‹ã€‚",
        "è·é›¢ãŒç¸®ã‚€ã»ã©é¢å€’è¦‹ãŒè‰¯ãã€ã¾ã¨ã‚å½¹ã«ãªã‚Šã‚„ã™ã„ã€‚"
      ]},
      overall:{title:"ğŸŒ å…¨ä½“é‹", body:[
        "äººç”Ÿã¯å¾ŒåŠã»ã©æº€è¶³åº¦ãŒä¸ŠãŒã‚Šã‚„ã™ã„ã€‚",
        "åœŸå°ã¥ãã‚Šã‚’ä¸å¯§ã«éã”ã™ã»ã©ã€å¾Œã§å¤§ããå›åã—ã‚„ã™ã„ã€‚",
        "ç„¦ã‚Šã‚ˆã‚Šã‚‚ç¶™ç¶šãŒé‹å‹¢ã‚’å¼·ã‚ã‚‹ã€‚"
      ]},
      work:{title:"ğŸ’¼ ä»•äº‹é‹", body:[
        "ä¼ç”»ãƒ»è¡¨ç¾ãƒ»ç™ºä¿¡ãƒ»ãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚¹å¯„ã‚Šã§ä¼¸ã³ã‚„ã™ã„ã€‚",
        "å€‹äººè£é‡ãŒå¤§ãã„ã»ã©åŠ›ã‚’å‡ºã—ã‚„ã™ãã€ç©ã¿ä¸Šã’å‹ã§å¼·ã„ã€‚",
        "åŸºç¤ã‚’ä½œã£ãŸã‚ã¨ã«è©•ä¾¡ãŒè¿½ã„ã¤ãã‚„ã™ã„ã€‚"
      ]},
      money:{title:"ğŸ’° é‡‘é‹", body:[
        "æ³¢ã¯å‡ºã‚„ã™ã„ãŒå›ååŠ›ãŒå¼·ã„ã€‚",
        "å›ºå®šè²»ã‚„ãƒ«ãƒ¼ãƒ«ã‚’æ•´ãˆã‚‹ã»ã©å®‰å®šã—ã‚„ã™ã„ã€‚",
        "é•·æœŸè¦–ç‚¹ã®è“„ç©ã¨ç›¸æ€§ãŒè‰¯ã„ã€‚"
      ]},
      health:{title:"ğŸ« å¥åº·é‹", body:[
        "ã‚¹ãƒˆãƒ¬ã‚¹ãŒç¡çœ ãƒªã‚ºãƒ ã«å‡ºã‚„ã™ã„ã€‚",
        "ä¼‘é¤Šã¯é‹å‹¢ç¶­æŒã®è¦ã«ãªã‚Šã‚„ã™ã„ã€‚",
        "ç„¡ç†ã‚’æºœã‚ãªã„è¨­è¨ˆãŒé–‹é‹ã«ãªã‚‹ã€‚"
      ]},
      love:{title:"â¤ï¸ æ‹æ„›é‹", body:[
        "è»½ã„æ‹ã‚ˆã‚Šã€äººç”Ÿã‚’æ•´ãˆã‚‹é–¢ä¿‚ã«ç¸ãŒå‡ºã‚„ã™ã„ã€‚",
        "ä»•äº‹ã‚„ç”Ÿæ´»ã®å®‰å®šã¨æ‹æ„›é‹ãŒé€£å‹•ã—ã‚„ã™ã„ã€‚",
        "ç²¾ç¥çš„ã«è‡ªç«‹ã—ãŸç›¸æ‰‹ã¨å¥½ç›¸æ€§ã€‚"
      ]},
      turning:{title:"ğŸ§­ æµã‚Œã®åˆ‡ã‚Šæ›¿ã‚ã‚Š", body:[
        "åŸºç¤å·¥äº‹ â†’ è©•ä¾¡ â†’ å®‰å®šæ‹¡å¼µ â†’ å®Œæˆã€ã®é †ã§å¼·ããªã‚Šã‚„ã™ã„ã€‚",
        "ä¸€æ°—ã«å¤‰ãˆã‚‹ã‚ˆã‚Šã€ç©ã‚“ã§åŠ¹ã‹ã›ã‚‹æ–¹ãŒå‹ã¦ã‚‹ã€‚"
      ]},
      final:{title:"ğŸ•Š æœ€çµ‚è©•ä¾¡", body:[
        "é™ã‹ã«ç©ã¿ä¸Šã’ã€å¾ŒåŠã§å¤§ããå ±ã‚ã‚Œã‚‹é…ç½®ã€‚",
        "äººç”Ÿæº€è¶³åº¦ã‚’é«˜ã‚ã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã€‚"
      ]}
    },

    B: {
      name: "å®‰å®šæˆé•·ãƒ»å …å®Ÿç©ã¿ä¸Šã’",
      social:{title:"ğŸ§‘â€ğŸ¤â€ğŸ§‘ ç¤¾ä¼šã‚­ãƒ£ãƒ©", body:[
        "ç©ã‚„ã‹ã§ä¿¡é ¼ã•ã‚Œã‚„ã™ã„ã€‚",
        "ç´„æŸã‚’å®ˆã‚‹ãƒ»ç¶™ç¶šã™ã‚‹ã“ã¨ã§è©•ä¾¡ãŒå›ºã¾ã‚‹ã€‚",
        "èª¿æ•´å½¹ãƒ»å®Ÿå‹™ã§é ¼ã‚‰ã‚Œã‚„ã™ã„ã€‚"
      ]},
      overall:{title:"ğŸŒ å…¨ä½“é‹", body:[
        "å¤§æ³¢ä¹±ã¯å°‘ãªãã€å®‰å®šã—ã¦ç©ã¿ä¸ŠãŒã‚Šã‚„ã™ã„ã€‚",
        "ç”Ÿæ´»åŸºç›¤ãŒæ•´ã†ã»ã©é‹ãŒå¼·ããªã‚‹ã€‚",
        "é•·æœŸçš„ãªå®‰å¿ƒæ„Ÿã‚’ä½œã‚‹ã®ãŒå¾—æ„ã€‚"
      ]},
      work:{title:"ğŸ’¼ ä»•äº‹é‹", body:[
        "ç®¡ç†ãƒ»èª¿æ•´ãƒ»å®Ÿå‹™ã®è»¸ã§è©•ä¾¡ãŒä¸ŠãŒã‚‹ã€‚",
        "è²¬ä»»ã‚ã‚‹å½¹å‰²ã»ã©ä¿¡é ¼ãŒç©ã‚‚ã‚‹ã€‚",
        "ã‚³ãƒ„ã‚³ãƒ„å‹ã®æˆæœãŒå¾Œã§åŠ¹ãã€‚"
      ]},
      money:{title:"ğŸ’° é‡‘é‹", body:[
        "è“„ç©å‹ã§å®ˆã‚ŠãŒå¼·ã„ã€‚",
        "å›ºå®šè²»ã®æœ€é©åŒ–ãŒä¸€ç•ªåŠ¹ãã€‚",
        "å …å®Ÿãªå¢—ã‚„ã—æ–¹ãŒå‘ãã€‚"
      ]},
      health:{title:"ğŸ« å¥åº·é‹", body:[
        "ç–²åŠ´ãŒç¡çœ ã«å‡ºã‚„ã™ã„ã€‚",
        "ä¼‘é¤Šã‚’ä»•çµ„ã¿åŒ–ã™ã‚‹ã¨å®‰å®šã€‚",
        "ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ãŒå¥åº·é‹ã‚’åº•ä¸Šã’ã™ã‚‹ã€‚"
      ]},
      love:{title:"â¤ï¸ æ‹æ„›é‹", body:[
        "é•·æœŸå®‰å®šã®æ‹æ„›ã«å¼·ã„ã€‚",
        "é–¢ä¿‚ãŒè‚²ã¤ã»ã©å®‰å¿ƒæ„ŸãŒå¢—ã™ã€‚",
        "å®¶åº­é‹ãŒäººç”Ÿã®åŸºç›¤ã«ãªã‚Šã‚„ã™ã„ã€‚"
      ]},
      turning:{title:"ğŸ§­ æµã‚Œã®åˆ‡ã‚Šæ›¿ã‚ã‚Š", body:[
        "å®‰å®š â†’ å½¹å‰²å¢— â†’ ä¿¡é ¼å›ºå®š â†’ ç”Ÿæ´»å®Œæˆã€ã®é †ã§è‰¯ããªã‚Šã‚„ã™ã„ã€‚",
        "è‰¯ã„ç¿’æ…£ã®ç©ã¿ä¸Šã’ãŒé‹ã‚’ä¸Šã’ã‚‹ã€‚"
      ]},
      final:{title:"ğŸ•Š æœ€çµ‚è©•ä¾¡", body:[
        "é•·æœŸçš„ãªå®‰å®šã¨æº€è¶³ã‚’ä½œã‚Šã‚„ã™ã„ã€‚",
        "å®‰å¿ƒæ„ŸãŒå¢—ãˆã¦ã„ãã‚¿ã‚¤ãƒ—ã€‚"
      ]}
    },

    C: {
      name: "å¤‰åŒ–é©å¿œãƒ»æŒ‘æˆ¦ã§ä¼¸ã³ã‚‹",
      social:{title:"ğŸ§‘â€ğŸ¤â€ğŸ§‘ ç¤¾ä¼šã‚­ãƒ£ãƒ©", body:[
        "è©±é¡Œæ€§ãƒ»è¡Œå‹•åŠ›ãŒè©•ä¾¡ã•ã‚Œã‚„ã™ã„ã€‚",
        "æ–°ã—ã„å ´æ‰€ã§ä¼¸ã³ã‚‹ã€‚",
        "å¤‰åŒ–ãŒã‚ã‚‹ã»ã©é­…åŠ›ãŒå‡ºã‚‹ã€‚"
      ]},
      overall:{title:"ğŸŒ å…¨ä½“é‹", body:[
        "åœæ»ã‚ˆã‚Šå¤‰åŒ–ã§é‹ãŒå‹•ãã€‚",
        "æ–°è¦æŒ‘æˆ¦ã®æ•°ãŒæœªæ¥ã‚’ä½œã‚‹ã€‚",
        "æŸ”è»Ÿãªåˆ‡ã‚Šæ›¿ãˆãŒå¼·ã¿ã€‚"
      ]},
      work:{title:"ğŸ’¼ ä»•äº‹é‹", body:[
        "æ–°è¦ãƒ»ä¼ç”»ãƒ»æ‹¡å¼µã«å¼·ã„ã€‚",
        "å˜èª¿ã•ã‚ˆã‚Šå¤‰åŒ–ã®ã‚ã‚‹ç’°å¢ƒãŒåˆã†ã€‚",
        "å‹•ããªãŒã‚‰æ•´ãˆã‚‹ã¨æˆæœãŒå‡ºã‚„ã™ã„ã€‚"
      ]},
      money:{title:"ğŸ’° é‡‘é‹", body:[
        "åå…¥æºã‚’è¤‡ç·šåŒ–ã™ã‚‹ã¨å¼·ã„ã€‚",
        "å‹¢ã„ã§å¢—ãˆã‚‹ãŒç®¡ç†ãŒå¼±ã„ã¨æ¸›ã‚Šã‚„ã™ã„ã€‚",
        "ä»•çµ„ã¿åŒ–ãŒå®‰å®šã®éµã€‚"
      ]},
      health:{title:"ğŸ« å¥åº·é‹", body:[
        "ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®ä¸Šä¸‹ãŒä½“ã«å‡ºã‚„ã™ã„ã€‚",
        "ç¡çœ ã¨é£Ÿäº‹ã®å›ºå®šãŒåœŸå°ã€‚",
        "ä¼‘ã‚€æ—¥ã‚’æ±ºã‚ã‚‹ã¨å®‰å®šã™ã‚‹ã€‚"
      ]},
      love:{title:"â¤ï¸ æ‹æ„›é‹", body:[
        "å‡ºä¼šã„ãŒå¤šãã€å‹•ãã»ã©ç¸ãŒå¢—ãˆã‚‹ã€‚",
        "å‹¢ã„ã§æ±ºã‚ã™ããªã„è¦‹æ¥µã‚ãŒå¤§äº‹ã€‚",
        "ç›¸æ‰‹ã¨æœªæ¥è¨­è¨ˆã§ãã‚‹ã¨å¼·ã„ã€‚"
      ]},
      turning:{title:"ğŸ§­ æµã‚Œã®åˆ‡ã‚Šæ›¿ã‚ã‚Š", body:[
        "æŒ‘æˆ¦ â†’ é©å¿œ â†’ ä»•çµ„ã¿åŒ– â†’ å®‰å®šã€ã®é †ã§å¼·ããªã‚‹ã€‚",
        "æŒ‘æˆ¦ãŒæ­¢ã¾ã‚‹ã¨é‹ã‚‚æ­¢ã¾ã‚Šã‚„ã™ã„ã€‚"
      ]},
      final:{title:"ğŸ•Š æœ€çµ‚è©•ä¾¡", body:[
        "å¤‰åŒ–ã‚’å‘³æ–¹ã«ã¤ã‘ã‚‹ã»ã©ä¸ŠãŒã‚‹ã€‚",
        "æŒ‘æˆ¦ã®æ•°ãŒäººç”Ÿã®åšã¿ã«ãªã‚‹ã€‚"
      ]}
    },
  }
};

/* =========================================================
  UIåˆæœŸåŒ–ï¼ˆãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã®ä¸­èº«ï¼‰
  âœ…åˆå¿ƒè€…å‘ã‘ï¼šé…åˆ—ã‚’è¶³ã›ã°é …ç›®ãŒå¢—ãˆã‚‹
========================================================= */
const PREFECTURES = [
  "éƒ½é“åºœçœŒ",
  "åŒ—æµ·é“","é’æ£®çœŒ","å²©æ‰‹çœŒ","å®®åŸçœŒ","ç§‹ç”°çœŒ","å±±å½¢çœŒ","ç¦å³¶çœŒ",
  "èŒ¨åŸçœŒ","æ ƒæœ¨çœŒ","ç¾¤é¦¬çœŒ","åŸ¼ç‰çœŒ","åƒè‘‰çœŒ","æ±äº¬éƒ½","ç¥å¥ˆå·çœŒ",
  "æ–°æ½ŸçœŒ","å¯Œå±±çœŒ","çŸ³å·çœŒ","ç¦äº•çœŒ","å±±æ¢¨çœŒ","é•·é‡çœŒ",
  "å²é˜œçœŒ","é™å²¡çœŒ","æ„›çŸ¥çœŒ","ä¸‰é‡çœŒ",
  "æ»‹è³€çœŒ","äº¬éƒ½åºœ","å¤§é˜ªåºœ","å…µåº«çœŒ","å¥ˆè‰¯çœŒ","å’Œæ­Œå±±çœŒ",
  "é³¥å–çœŒ","å³¶æ ¹çœŒ","å²¡å±±çœŒ","åºƒå³¶çœŒ","å±±å£çœŒ",
  "å¾³å³¶çœŒ","é¦™å·çœŒ","æ„›åª›çœŒ","é«˜çŸ¥çœŒ",
  "ç¦å²¡çœŒ","ä½è³€çœŒ","é•·å´çœŒ","ç†Šæœ¬çœŒ","å¤§åˆ†çœŒ","å®®å´çœŒ","é¹¿å…å³¶çœŒ","æ²–ç¸„çœŒ"
];

const TIME_BLOCKS = [
  "ä¸æ˜",
  "æ—©æœï¼ˆ5â€“8ï¼‰",
  "åˆå‰ï¼ˆ8â€“12ï¼‰",
  "æ˜¼ï¼ˆ12â€“15ï¼‰",
  "å¤•æ–¹ï¼ˆ15â€“18ï¼‰",
  "å¤œï¼ˆ18â€“22ï¼‰",
  "æ·±å¤œï¼ˆ22â€“5ï¼‰"
];

function initSelect(id, items){
  const el = document.getElementById(id);
  el.innerHTML = "";
  for (const s of items){
    const opt = document.createElement("option");
    opt.value = s;
    opt.textContent = s;
    el.appendChild(opt);
  }
}

/* =========================================================
  ã“ã“ã‹ã‚‰ä¸‹ã¯ã€ŒåŸºæœ¬è§¦ã‚‰ãªã„ã€é ˜åŸŸï¼ˆè¨ˆç®—ãƒ»çµ„ã¿ç«‹ã¦ï¼‰
========================================================= */
const $ = (id) => document.getElementById(id);
function pad2(n){ return String(n).padStart(2,"0"); }
function pickOne(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function stripPeriod(s){ return s.replace(/ã€‚$/, ""); }

function calcLifePathNumber(dateObj){
  const s = `${dateObj.getFullYear()}${pad2(dateObj.getMonth()+1)}${pad2(dateObj.getDate())}`;
  let sum = 0;
  for (const ch of s) sum += Number(ch);
  while (sum > 9) sum = String(sum).split("").reduce((a,c)=>a+Number(c),0);
  return sum; // 1-9
}

function calcAge(dateObj){
  const today = new Date();
  let age = today.getFullYear() - dateObj.getFullYear();
  const birthdayThisYear = new Date(today.getFullYear(), dateObj.getMonth(), dateObj.getDate());
  if (today < birthdayThisYear) age -= 1;
  return age;
}

function calcZodiacSign(dateObj){
  const m = dateObj.getMonth()+1, d = dateObj.getDate();
  if ((m==1 && d>=20) || (m==2 && d<=18)) return "æ°´ç“¶åº§";
  if ((m==2 && d>=19) || (m==3 && d<=20)) return "é­šåº§";
  if ((m==3 && d>=21) || (m==4 && d<=19)) return "ç‰¡ç¾Šåº§";
  if ((m==4 && d>=20) || (m==5 && d<=20)) return "ç‰¡ç‰›åº§";
  if ((m==5 && d>=21) || (m==6 && d<=21)) return "åŒå­åº§";
  if ((m==6 && d>=22) || (m==7 && d<=22)) return "èŸ¹åº§";
  if ((m==7 && d>=23) || (m==8 && d<=22)) return "ç…å­åº§";
  if ((m==8 && d>=23) || (m==9 && d<=22)) return "ä¹™å¥³åº§";
  if ((m==9 && d>=23) || (m==10 && d<=23)) return "å¤©ç§¤åº§";
  if ((m==10 && d>=24) || (m==11 && d<=22)) return "è åº§";
  if ((m==11 && d>=23) || (m==12 && d<=21)) return "å°„æ‰‹åº§";
  return "å±±ç¾Šåº§";
}

/* ---- 20ã‚¿ã‚¤ãƒ—æ±ºå®šï¼ˆ4å±æ€§Ã—5ã‚«ãƒ†ã‚´ãƒªï¼20ï¼‰ ----
   âœ…å°†æ¥ã®æ‹¡å¼µæ¡ˆï¼š
   - å‡ºç”Ÿæ™‚é–“(time)ã§ bucket ã‚’å¾®èª¿æ•´ï¼ˆä¾‹ï¼šå¤œã¯â€œæ¢æ±‚â€å¯„ã‚Šâ€¦ãªã©ï¼‰
   - å‡ºç”Ÿåœ°(place)ã§æ–‡ç« ã®èªå½™ã‚’å¤‰ãˆã‚‹ï¼ˆæ–¹è¨€/åœ°åŸŸãƒ¢ãƒãƒ¼ãƒ•ï¼‰
*/
function signToElement(sign){
  const fire  = ["ç‰¡ç¾Šåº§","ç…å­åº§","å°„æ‰‹åº§"];
  const earth = ["ç‰¡ç‰›åº§","ä¹™å¥³åº§","å±±ç¾Šåº§"];
  const air   = ["åŒå­åº§","å¤©ç§¤åº§","æ°´ç“¶åº§"];
  const water = ["èŸ¹åº§","è åº§","é­šåº§"];
  if (fire.includes(sign)) return "FIRE";
  if (earth.includes(sign)) return "EARTH";
  if (air.includes(sign)) return "AIR";
  return "WATER";
}
function lifePathToBucket(lp){
  if (lp === 9) return 5;                // å®Œæˆ
  if (lp === 7 || lp === 8) return 4;    // æ¢æ±‚
  if (lp === 5 || lp === 6) return 3;    // æŒ‘æˆ¦
  if (lp === 3 || lp === 4) return 2;    // ä¼¸é•·
  return 1;                               // å®‰å®šï¼ˆ1,2ï¼‰
}
function pickType20({ sign, lifepath }){
  const elementKey = signToElement(sign);
  const bucket = lifePathToBucket(lifepath);
  const typeKey = `${elementKey}_${bucket}`; // ä¾‹ï¼šFIRE_3
  return { typeKey, elementKey, bucket };
}

/* ---- è©³ç´°é‘‘å®šã®æœ¬æ–‡ã‚¿ã‚¤ãƒ—ï¼ˆA/B/Cï¼‰ ----
   âœ…å°†æ¥ï¼šã“ã“ã‚’å¢—ã‚„ã—ã¦æœ¬æ–‡ã‚¿ã‚¤ãƒ—ã‚’10ç¨®é¡ã¨ã‹ã«ã§ãã‚‹
*/
function pickDetailArchetypeABC({ sign, lifepath }){
  if (lifepath === 5) return "C";
  if (lifepath === 7) return "A";
  if (["å±±ç¾Šåº§","ä¹™å¥³åº§","ç‰¡ç‰›åº§"].includes(sign)) return (lifepath === 4 || lifepath === 8) ? "A" : "B";
  if (["ç…å­åº§","ç‰¡ç¾Šåº§","å°„æ‰‹åº§"].includes(sign)) return "C";
  if (lifepath === 4 || lifepath === 8) return "A";
  return "B";
}

function formatDateJP(dateObj){
  return `${dateObj.getFullYear()}/${pad2(dateObj.getMonth()+1)}/${pad2(dateObj.getDate())}`;
}
function bullet(lines){
  return lines.map(s => `ãƒ»${s}`).join("\n");
}

function getKumaTypeInfo({ elementKey, bucket }){
  const el = TEXT_DB.kumaTypeSeeds.elements.find(e=>e.key===elementKey);
  const bk = TEXT_DB.kumaTypeSeeds.buckets.find(b=>b.idx===bucket);

  // âœ…ã‚¿ã‚¤ãƒ—åï¼šã“ã“ã‚’å®Œå…¨æ‰‹æ‰“ã¡ã®20å€‹ã«ç½®ãæ›ãˆã¦ã‚‚OK
  const displayName = `${el.name}${bk.name}ã‚°ãƒ`;      // ä¾‹ï¼šç«æŒ‘æˆ¦ã‚°ãƒ
  const oneLiner = `${el.vibe} Ã— ${bk.desc}`;         // ä¾‹ï¼šå‹¢ã„ã¨çªç ´ Ã— å‹•ã„ãŸã¶ã‚“ã ã‘é‹ãŒå‹•ã
  return { displayName, oneLiner, elementName: el.name, bucketName: bk.name };
}

function buildReading(params){
  const { name, place, time, dobStr, toneKey } = params;
  const birth = new Date(dobStr);

  const lp = calcLifePathNumber(birth);
  const sign = calcZodiacSign(birth);
  const age = calcAge(birth);

  const signVibe = TEXT_DB.signs[sign]?.vibe ?? "";
  const lpVibe = TEXT_DB.lifepath[lp] ?? "";

  // 20ã‚¿ã‚¤ãƒ—
  const { typeKey, elementKey, bucket } = pickType20({ sign, lifepath: lp });
  const kuma = getKumaTypeInfo({ elementKey, bucket });

  // è©³ç´°æœ¬æ–‡ã‚¿ã‚¤ãƒ—ï¼ˆA/B/Cï¼‰
  const abc = pickDetailArchetypeABC({ sign, lifepath: lp });
  const arch = TEXT_DB.archetypes[abc];

  // å£èª¿
  const tone = TEXT_DB.tones[toneKey] ?? TEXT_DB.tones.normal;

  // ===== ç”»é¢è¡¨ç¤ºï¼ˆçŸ­ãï¼‰ =====
  $("badgeSign").textContent = `${sign}ï¼ˆ${signVibe}ï¼‰`;
  $("badgeLP").textContent = `${lp}ï¼ˆ${lpVibe}ï¼‰`;
  $("badgeAge").textContent = `ç¾åœ¨ï¼š${age}æ­³ç›®å®‰`;

  $("typeTitle").textContent = `ã‚¿ã‚¤ãƒ—ï¼š${kuma.displayName}`;
  $("typeDesc").textContent = kuma.oneLiner;
  $("typeMeta").textContent = `ã‚¿ã‚¤ãƒ—ã‚­ãƒ¼ï¼š${typeKey}`;

  // ===== æœ¬æ–‡ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¦‹ã›ã‚‹å®Œæˆãƒ†ã‚­ã‚¹ãƒˆï¼‰ =====
  // âœ…ã“ã“ã«ã€Œé–‹ç™ºæ³¨é‡ˆã€ã¯çµ¶å¯¾ã«å…¥ã‚Œãªã„æ–¹é‡
  const out = [];

  out.push(`# ğŸ» ã‚¯ãƒã‚¿ã‚¤ãƒ—ï¼š${kuma.displayName}`);
  out.push(`${kuma.oneLiner}`);
  out.push(""); // 1è¡Œç©ºã‘ã‚‹

  out.push(`# ğŸ”® è©³ç´°é‘‘å®šï¼š${name || "ï¼ˆåå‰æœªå…¥åŠ›ï¼‰"}`);
  out.push("");

  out.push(`ç”Ÿå¹´æœˆæ—¥ï¼š${formatDateJP(birth)}`);
  if (CONFIG.showMeta){
    // å…¬é–‹ã—ã¦ã‚‚é•å’Œæ„Ÿã®ãªã„ç¯„å›²ã§â€œè¡¨ç¤ºã ã‘â€ã—ã¦ãŠã
    out.push(`å‡ºç”Ÿåœ°ï¼š${place || "éƒ½é“åºœçœŒ"}`);
    out.push(`å‡ºç”Ÿæ™‚é–“ï¼š${time || "ä¸æ˜"}`);
  }
  out.push(`æ˜Ÿåº§ï¼š${sign}ï¼ˆ${signVibe}ï¼‰`);
  out.push(`æ•°ç§˜ï¼š${lp}ï¼ˆ${lpVibe}ï¼‰`);
  out.push("");

  out.push(tone.header);
  out.push("");

  for (const key of CONFIG.sections){
    const sec = arch[key];
    if (!sec) continue;
    out.push(`## ${sec.title}`);
    const toned = sec.body.map(tone.line);
    out.push(bullet(toned));
    out.push("");
  }

  out.push(tone.footer);

  return out.join("\n");
}

/* =========================================================
  ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒœã‚¿ãƒ³é¡ï¼‰
========================================================= */
function handleGenerate(){
  const dob = $("dob").value;
  if (!dob) return alert("ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ã­");

  const text = buildReading({
    name: $("name").value,
    place: $("place").value,
    time: $("time").value,
    dobStr: dob,
    toneKey: $("tone").value
  });

  $("out").value = text;
  $("outputCard").scrollIntoView({ behavior:"smooth", block:"start" });
}

async function handleCopy(){
  const text = $("out").value;
  if (!text.trim()) return alert("å…ˆã«ç”Ÿæˆã—ã¦ã­");
  await navigator.clipboard.writeText(text);
  alert("ã‚³ãƒ”ãƒ¼ã—ãŸã‚ˆ");
}

function handleClear(){
  $("name").value = "";
  $("dob").value = "";
  $("place").value = "éƒ½é“åºœçœŒ";
  $("time").value = "ä¸æ˜";
  $("tone").value = "normal";

  $("badgeSign").textContent = "-";
  $("badgeLP").textContent = "-";
  $("badgeAge").textContent = "-";

  $("typeTitle").textContent = "ã‚¿ã‚¤ãƒ—ï¼š-";
  $("typeDesc").textContent = "ç”Ÿå¹´æœˆæ—¥ã‚’å…¥ã‚Œã¦ã€Œç”Ÿæˆã€ã‚’æŠ¼ã—ã¦ã­ã€‚";
  $("typeMeta").textContent = "-";

  $("out").value = "";
}

/* =========================================================
  åˆæœŸåŒ–
========================================================= */
(function init(){
  initSelect("place", PREFECTURES);
  initSelect("time", TIME_BLOCKS);

  $("gen").addEventListener("click", handleGenerate);
  $("copy").addEventListener("click", handleCopy);
  $("clear").addEventListener("click", handleClear);
})();
</script>
</body>
</html>
