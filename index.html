<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>クマ占いジェネレーター v17</title>
  <link rel="stylesheet" href="./css/style.css" />
</head>

<body>
  <div class="wrap">
    <header class="header">
      <h1>クマ占いジェネレーター</h1>
      <p class="sub">ふわふわ見た目 × 裏はガチ寄り（出生時間なしでも成立）</p>
      <p class="ver">Version 10</p>
    </header>

    <main class="grid">

      <!-- 入力 -->
      <section class="card">
        <h2 class="sectionTitle">入力</h2>

        <label>名前（漢字など）</label>
        <input id="name" placeholder="例：山田 太郎" autocomplete="name" />

        <label>ふりがな（ひらがな・任意）</label>
        <input id="kana" placeholder="例：やまだ たろう" />

        <label>生年月日</label>
        <input id="dob" type="date" />

        <label>出生地（都道府県）</label>
        <select id="pref"></select>

        <label>出生時間（任意）</label>
        <div class="timeBlock">

          <div class="timeMode">
            <label class="radio">
              <input type="radio" name="timeMode" id="timeModeUnknown" value="unknown" checked>
              <span>不明</span>
            </label>
            <label class="radio">
              <input type="radio" name="timeMode" id="timeModeSet" value="set">
              <span>入力する</span>
            </label>
          </div>

          <div class="timePick" id="timePick" aria-hidden="true">
            <div class="row2">
              <div>
                <label class="miniLabel">時</label>
                <select id="timeHour"></select>
              </div>
              <div>
                <label class="miniLabel">分</label>
                <div class="seg">
                  <button type="button" class="segBtn" data-min="00" id="min00">00</button>
                  <button type="button" class="segBtn" data-min="30" id="min30">30</button>
                </div>
              </div>
            </div>
            <input type="hidden" id="timeValue" value="不明" />
          </div>
        </div>

        <label>鑑定スタイル（文章の雰囲気）</label>
        <select id="tone">
          <option value="soft">やさしめ</option>
          <option value="standard" selected>標準</option>
          <option value="toxic">毒舌</option>
        </select>

        <div class="btns">
          <button class="primary" id="gen">出力</button>
          <button id="copy">コピー</button>
          <button id="clear">クリア</button>
        </div>

        <p class="hint">
          デザイン：<b>css/style.css</b><br>
          文章：<b>js/data.js</b> ／ ロジック：<b>js/fortune.js</b>
        </p>
      </section>

      <!-- 出力 -->
      <section class="card">
        <h2 class="sectionTitle">出力</h2>

        <div class="badges">
          <span class="pill">タイプ</span><span id="badgeType">-</span>
          <span class="pill">相性軸</span><span id="badgeAxis">-</span>
          <span class="pill">精度</span><span id="badgeLevel">-</span>
        </div>

        <div class="typeBox">
          <div class="typeImgWrap">
            <img id="typeImg" alt="type illust" />
          </div>
          <div class="typeText">
            <div class="typeName" id="typeName">-</div>
            <div class="typeOneLine" id="typeOneLine">-</div>
          </div>
        </div>

        <label style="margin-top:12px;">結果テキスト</label>
        <textarea id="out" readonly></textarea>

        <p class="hint">
          ※ふりがなが入ってると名前要素の精度が上がる（未入力でもOK）
        </p>
      </section>

    </main>
  </div>

  <!-- JS読み込み順：これが超重要 -->
  <script src="./js/data.js"></script>
  <script src="./js/utils.js"></script>
  <script src="./js/fortune.js"></script>
  <script src="./js/app.js"></script>





  <script>
  console.log("TEST: scripts loaded?");
  console.log("PREFS length:", window.PREFS ? window.PREFS.length : "PREFS is undefined");
  console.log("HOURS length:", window.HOURS ? window.HOURS.length : "HOURS is undefined");
  console.log("Utils exists:", !!window.Utils);

  // 強制的に都道府県と時を入れる（これで出ないならDOMかパスが原因）
  (function forceFill(){
    const pref = document.getElementById("pref");
    const hour = document.getElementById("timeHour");
    if (!pref || !hour) {
      console.log("pref/timeHour element missing", { pref, hour });
      return;
    }

    const prefs = window.PREFS || [];
    const hours = window.HOURS || [];

    pref.innerHTML = `<option value="">選択してね</option>` + prefs.map(p => `<option>${p}</option>`).join("");
    hour.innerHTML = `<option value="">選択</option>` + hours.map(h => `<option>${h}</option>`).join("");

    console.log("forceFill done.", { prefs: prefs.length, hours: hours.length });
  })();
</script>

  

  
</body>
</html>
